<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>A-Kintai</title>
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TQP2EYCPBD"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-TQP2EYCPBD');
  </script>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />

  <link rel="icon" href="/favicon.png" sizes="any">

  <!--Firebase SDK
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-messaging-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
  -->

  <!-- FullCalendar / xlsx -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/main.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <!-- App styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- App script (ESM) 
  <script type="module" src="app.js"></script>
  -->
</head>
<body>
  <header>
    <h1 class="logo">
      <img src="a-kintai-logo-white.png" alt="A-Kintai">
      <span>朝日印刷の勤怠管理アプリ</span>
    </h1>
    <nav>
      <button id="tab-main" class="active">メイン</button>
      <button id="tab-settings">設定</button>
    </nav>
    <button id="btn-login">Googleでログイン</button>
    <button id="btn-logout" style="display:none;">ログアウト</button>
    <span id="login-status"></span>
  </header>

  <section id="main">
    <div class="toolbar">
      <button id="btn-export-xlsx">Excelエクスポート（今月・社員別シート）</button>
    </div>

    <h2>予定の登録</h2>
    <div class="form">
      <label>社員</label>
      <select id="employee"></select>

      <label>日付</label>
      <input type="date" id="date">

      <label>開始時刻</label>
      <input type="time" id="start" value="09:00">

      <label>時間(0.5刻み)</label>
      <input type="number" id="hours" step="0.5" min="0" value="8">

      <label>種別</label>
      <select id="type">
        <option value="paid">有給</option>
        <option value="overtime">残業</option>
        <option value="special">特別休暇</option>
        <option value="holiday">休日出勤</option>
        <option value="closed">休業</option>
      </select>

      <label>備考</label>
      <input type="text" id="note" placeholder="任意（例：午前用事）">

      <button onclick="submitKintai()">登録</button>
    </div>

    <div class="two-col">
      <div class="list-wrap">
        <h2>一覧</h2>
        <div class="list-toolbar">
          <button id="page-prev" type="button" onclick="goPrevPage()">← 前へ</button>
          <span id="page-info"></span>
          <button id="page-next" type="button" onclick="goNextPage()">次へ →</button>
        </div>

        <ul id="list"></ul>
      </div>
      <div class="calendar-wrap">
        <h2>カレンダー</h2>
        <div id="calendar"></div>
      </div>
    </div>

    <div class="rules">
      <h2>毎週スケジュールの登録</h2>
      <div class="form inline">
        <label>社員</label>
        <select id="rule-employee"></select>
        <label class="empty"></label>
        
        <label>曜日</label>
        <div id="rule-weekdays" class="weekday-list">
          <label><input type="checkbox" name="rule-weekdays" value="1">月</label>
          <label><input type="checkbox" name="rule-weekdays" value="2">火</label>
          <label><input type="checkbox" name="rule-weekdays" value="3">水</label>
          <label><input type="checkbox" name="rule-weekdays" value="4">木</label>
          <label><input type="checkbox" name="rule-weekdays" value="5">金</label>
          <label><input type="checkbox" name="rule-weekdays" value="6">土</label>
          <label><input type="checkbox" name="rule-weekdays" value="0">日</label>
        </div>

        <label>開始</label>
        <input type="date" id="rule-start">
        <label class="empty"></label>
        <label>終了</label>
        <input type="date" id="rule-end">

        <label>時間</label>
        <input type="number" id="rule-hours" step="0.5" min="0" value="8">
        <label class="empty"></label>
        <label>種別</label>
        <select id="rule-type">
          <option value="paid">有給</option>
          <option value="overtime">残業</option>
          <option value="special">特別休暇</option>
          <option value="holiday">休日出勤</option>
          <option value="closed">休業</option>
        </select>

        <label>備考</label>
        <input type="text" id="rule-note" placeholder="任意メモ">
        <label class="empty"></label>
        <label class="empty"></label>
        <button class="addrule" onclick="addWeeklyRule()">ルール追加</button>
      </div>
      <ul id="rule-list"></ul>
    </div>
  </section>

  <section id="settings" class="hidden">
    <h2>設定</h2>

    <!-- 社員追加フォーム（拡張） -->
    <div class="emp-setting form inline">
      <label>社員名</label>
      <input type="text" id="emp-name" placeholder="必須">
       

      <label>通知メール</label>
      <input type="email" id="emp-email" placeholder="任意（通知先）">
       

      <label>SMS番号</label>
      <input type="tel" id="emp-sms" placeholder="任意（090…）">
      

      <label>管理者</label>
      <div class="checkbox-cell">
        <input type="checkbox" id="emp-admin">
        <label for="emp-admin" class="chk-inline">管理者にする</label>
      </div>

      <label class="empty"></label>
      <button class="addEmployee" onclick="addEmployee()">社員を追加</button>
    </div>

    <h3>社員一覧</h3>
    <ul id="employees"></ul>

    <h3>社員別 集計（今月）</h3>
    <div id="summary"></div>
  </section>

  <!-- 予定 編集モーダル -->
  <div id="modal" class="modal hidden">
    <div class="modal-content">
      <h3>予定を編集</h3>
      <input type="hidden" id="edit-id">
      <div class="form">
        <label>社員</label>
        <select id="edit-employee"></select>

        <label>日付</label>
        <input type="date" id="edit-date">

        <label>開始時刻</label>
        <input type="time" id="edit-start">

        <label>時間(0.5刻み)</label>
        <input type="number" id="edit-hours" step="0.5" min="0">

        <label>種別</label>
        <select id="edit-type">
          <option value="paid">有給</option>
          <option value="overtime">残業</option>
          <option value="special">特別休暇</option>
          <option value="holiday">休日出勤</option>
          <option value="closed">休業</option>
        </select>

        <label>備考</label>
        <input type="text" id="edit-note" placeholder="任意メモ">

        <button id="btn-apply-edit" type="button" onclick="applyEdit()">更新する</button>
        <button class="secondary" onclick="closeModal()">キャンセル</button>
        <button type="button" class="danger" id="btn-modal-delete">削除する</button>
      </div>
    </div>
  </div>

  <!-- 社員 編集モーダル -->
  <div id="emp-modal" class="modal hidden">
    <div class="modal-content">
      <h3>社員を編集</h3>
      <input type="hidden" id="edit-emp-id">
      <div class="form">
        <label>社員名</label>
        <input type="text" id="edit-emp-name" placeholder="必須">

        <label>通知メール</label>
        <input type="email" id="edit-emp-email" placeholder="任意">

        <label>SMS番号</label>
        <input type="tel" id="edit-emp-sms" placeholder="任意">

        <label>管理者</label>
        <div class="checkbox-cell">
          <input type="checkbox" id="edit-emp-admin">
          <label for="edit-emp-admin" class="chk-inline">管理者にする</label>
        </div>

        <button onclick="applyEmpEdit()">更新する</button>
        <button class="secondary" onclick="closeEmpModal()">キャンセル</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
  <script type="module" src="/src/main.js"></script>

</body>
</html>
